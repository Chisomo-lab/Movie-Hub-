<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Movie Hub Pro</title>
<style>
body { font-family: Arial,sans-serif; background:#111; color:#fff; margin:0; padding:0; }
header { background:#e50914; padding:15px; text-align:center; font-size:28px; font-weight:bold; position:sticky; top:0; z-index:1000; }
nav { display:flex; overflow-x:auto; background:#000; padding:10px; position:sticky; top:55px; z-index:999; }
nav a { display:flex; flex-direction:column; align-items:center; margin:0 10px; text-decoration:none; color:#fff; font-weight:bold; min-width:70px; }
nav img { width:50px; height:50px; border-radius:5px; object-fit:cover; margin-bottom:5px; }
nav a:hover { color:#e50914; transform:scale(1.1); transition:0.3s; }
#searchBar { padding:10px; text-align:center; background:#000; }
#searchInput { width:70%; max-width:400px; padding:8px; border-radius:5px; border:none; font-size:16px; }
#searchBtn { padding:8px 15px; margin-left:10px; border:none; border-radius:5px; background:#e50914; color:#fff; cursor:pointer; }
#searchBtn:hover { background:#b00610; }
.category { margin:20px; }
.category h2 { border-left:5px solid #e50914; padding-left:10px; margin-bottom:10px; cursor:pointer; }
.movies { display:flex; flex-wrap:wrap; gap:15px; padding:10px 0; }
.movie-card { background:#222; border-radius:10px; width:180px; padding:10px; text-align:center; transition:0.3s; }
.movie-card:hover { transform:scale(1.05); box-shadow:0 0 15px #e50914; }
.movie-card img { width:100%; height:250px; object-fit:cover; border-radius:8px; }
.movie-card h3 { font-size:14px; margin:10px 0 5px; }
.movie-card a { display:inline-block; margin:5px; padding:5px 10px; background:#e50914; color:#fff; border-radius:5px; text-decoration:none; font-size:12px; cursor:pointer; }
.movie-card a:hover { background:#b00610; }
.load-more { margin:10px; padding:8px 15px; background:#e50914; border:none; border-radius:5px; cursor:pointer; color:#fff; }
.load-more:hover { background:#b00610; }
@media(max-width:600px){ .movie-card { width:140px; } nav img { width:40px; height:40px; } }
</style>

<!-- âœ… AdSense script only once -->
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3798659133542290"
     crossorigin="anonymous"></script>
</head>
<body>

<header>ðŸŽ¬ Movie Hub Pro</header>

<!-- âœ… Top Ad -->
<ins class="adsbygoogle"
     style="display:block; text-align:center; margin:15px 0;"
     data-ad-client="ca-pub-3798659133542290"
     data-ad-slot="6354626837"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>

<nav id="navbar"></nav>

<!-- âœ… Search bar -->
<div id="searchBar">
  <input type="text" id="searchInput" placeholder="Search movies...">
  <button id="searchBtn">Search</button>
</div>

<div id="searchResults"></div>
<div id="content"></div>

<!-- âœ… Middle Ad -->
<div id="midAd" style="margin:20px 0; text-align:center;"></div>

<!-- âœ… Footer Ad -->
<div style="margin:30px 0; text-align:center;">
  <ins class="adsbygoogle"
       style="display:block"
       data-ad-client="ca-pub-3798659133542290"
       data-ad-slot="6354626837"
       data-ad-format="auto"
       data-full-width-responsive="true"></ins>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
</div>

<script>
const categories = {
  "action": { collection:"feature_films", thumb:"https://archive.org/services/img/feature_films" },
  "comedy": { collection:"comedy", thumb:"https://archive.org/services/img/comedy" },
  "horror": { collection:"horror", thumb:"https://archive.org/services/img/horror" },
  "animation": { collection:"animationandcartoons", thumb:"https://archive.org/services/img/animationandcartoons" },
  "anime": { collection:"anime", thumb:"https://archive.org/services/img/anime" },
  "sci-fi": { collection:"sciencefiction", thumb:"https://archive.org/services/img/sciencefiction" }
};

const rowsPerLoad = 12;
let loadedCounts = {};
let catCount = 0;

// Navbar
const nav = document.getElementById("navbar");
Object.entries(categories).forEach(([cat, data])=>{
  const a = document.createElement("a");
  a.href = `#${cat}`;
  a.innerHTML = `<img src="${data.thumb}" onerror="this.src='https://via.placeholder.com/50x50?text=?'"><span>${cat.toUpperCase()}</span>`;
  nav.appendChild(a);
});

// Fetch movies
async function fetchMovies(query, start=0, rows=12){
  const url = `https://archive.org/advancedsearch.php?q=${encodeURIComponent(query)}+AND+mediatype:(movies)&fl[]=identifier&fl[]=title&fl[]=year&sort[]=downloads desc&output=json&rows=${rows}&start=${start}`;
  const res = await fetch(url);
  const data = await res.json();
  return data.response.docs;
}

// Load category
async function loadCategory(catId){
  const collection = categories[catId].collection;
  const start = loadedCounts[catId] || 0;
  const movies = await fetchMovies(`collection:(${collection})`, start, rowsPerLoad);
  loadedCounts[catId] = start + movies.length;

  let categoryDiv = document.getElementById(catId);
  if(!categoryDiv){
    categoryDiv = document.createElement("div");
    categoryDiv.className = "category";
    categoryDiv.id = catId;

    const title = document.createElement("h2");
    title.textContent = catId.toUpperCase();
    categoryDiv.appendChild(title);

    const moviesDiv = document.createElement("div");
    moviesDiv.className = "movies";
    categoryDiv.appendChild(moviesDiv);

    const loadBtn = document.createElement("button");
    loadBtn.textContent = "Load More";
    loadBtn.className = "load-more";
    loadBtn.onclick = ()=>loadCategory(catId);
    categoryDiv.appendChild(loadBtn);

    document.getElementById("content").appendChild(categoryDiv);

    catCount++;
    if(catCount === 2){
      document.getElementById("midAd").innerHTML = `
        <ins class="adsbygoogle"
             style="display:block"
             data-ad-client="ca-pub-3798659133542290"
             data-ad-slot="6354626837"
             data-ad-format="auto"
             data-full-width-responsive="true"></ins>
        <script>(adsbygoogle = window.adsbygoogle || []).push({});<\/script>
      `;
    }
  }

  const moviesDiv = categoryDiv.querySelector(".movies");
  renderMovies(movies, moviesDiv);
}

// Render function
function renderMovies(movies, container){
  movies.forEach(movie=>{
    const card = document.createElement("div");
    card.className="movie-card";
    const identifier = movie.identifier;
    const streamPageUrl = `https://archive.org/details/${identifier}`;
    const downloadUrl = `https://archive.org/download/${identifier}/${identifier}.mp4`;

    card.innerHTML = `
      <img src="https://archive.org/services/img/${identifier}" alt="${movie.title}" onerror="this.src='https://via.placeholder.com/180x250?text=No+Image'">
      <h3>${movie.title || "Untitled"} (${movie.year || "N/A"})</h3>
      <a href="${streamPageUrl}" target="_blank">Stream</a>
      <a href="${downloadUrl}" target="_blank">Download</a>
    `;
    container.appendChild(card);
  });
}

// Search
document.getElementById("searchBtn").addEventListener("click", async ()=>{
  const query = document.getElementById("searchInput").value.trim();
  if(!query) return;
  const resultsDiv = document.getElementById("searchResults");
  resultsDiv.innerHTML = `<h2 style="margin:20px;">Search Results for "${query}"</h2><div class="movies"></div>`;
  const movies = await fetchMovies(query, 0, 20);
  renderMovies(movies, resultsDiv.querySelector(".movies"));
});

// Load initial categories
Object.keys(categories).forEach(cat=>{ loadedCounts[cat]=0; loadCategory(cat); });
</script>
</body>
</html>
